<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flexcoin — $FLEX</title>
  <link rel="icon" href="./public/favicon.ico">
  <style>
    :root{
      --bg:#11100d; --card:#1b1915; --text:#eadfbb; --muted:#b9a97a; --accent:#8b7e45;
      --gold:#d0b24a; --chip:#3a331c; --ok:#2ea043; --warn:#d29922; --err:#f85149;
    }
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,Apple SD Gothic Neo,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}

    /* Top bar */
    .topbar{
      position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:.5rem;
      padding:.75rem 1rem;background:linear-gradient(180deg,rgba(0,0,0,.45),rgba(0,0,0,0));
      backdrop-filter:saturate(1.2) blur(6px);
    }
    .brand{font-weight:700;color:var(--gold);}
    .spacer{flex:1}
    .btn{display:inline-flex;align-items:center;gap:.4rem;border:none;border-radius:.7rem;
      background:var(--chip);color:var(--text);padding:.45rem .8rem;cursor:pointer}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .chip{border:1px solid rgba(255,255,255,.08)}
    .lang{display:inline-flex;border-radius:.6rem;overflow:hidden;border:1px solid rgba(255,255,255,.08)}
    .lang button{background:var(--chip);padding:.45rem .7rem;border:0;color:var(--text);cursor:pointer}
    .lang button.active{background:var(--accent);color:black;font-weight:700}

    /* Layout */
    .wrap{max-width:1080px;margin:0 auto;padding:1rem}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:14px}
    .mt{margin-top:1.25rem}

    /* Hero */
    .hero{position:relative;border-radius:14px;overflow:hidden}
    .hero img{width:100%;display:block}
    .hero-rot{display:grid;grid-template-columns:repeat(4,1fr);gap:.5rem;margin-top:.5rem}
    .hero-rot img{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:8px;cursor:pointer;opacity:.85}
    .hero-rot img:hover{opacity:1}

    /* Gallery */
    .grid4{display:grid;grid-template-columns:repeat(4,1fr);gap:.5rem}
    .grid4 img{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:10px;cursor:pointer}

    /* Lightbox */
    #lightbox{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;place-items:center;z-index:60}
    #lightbox img{max-width:92vw;max-height:88vh;border-radius:10px}

    /* Tokenomics */
    .row{display:grid;grid-template-columns:320px 1fr;gap:1rem}
    @media (max-width:820px){ .row{grid-template-columns:1fr} .grid4{grid-template-columns:repeat(2,1fr)} .hero-rot{grid-template-columns:repeat(4,1fr)} }
    canvas{background:#0f0e0c;border-radius:14px}

    .legend li{list-style:none;margin:.25rem 0}
    .dot{display:inline-block;width:.8rem;height:.8rem;border-radius:99px;margin-right:.4rem;vertical-align:middle}

    /* Small text */
    .muted{color:var(--muted);font-size:.9rem}
    .section-title{font-size:1.4rem;font-weight:800;margin:.4rem 0 1rem;color:var(--gold)}
    a.link{color:var(--gold);text-decoration:none}
    .downloads a{display:inline-block;margin:.25rem .4rem .25rem 0;padding:.45rem .65rem;background:var(--chip);border-radius:.6rem;border:1px solid rgba(255,255,255,.08)}
    .addr table{width:100%;border-collapse:collapse}
    .addr td{padding:.35rem .5rem;border-bottom:1px dashed rgba(255,255,255,.06);font-family:ui-monospace,Consolas,monospace}
    .count{font-weight:800;font-size:1.25rem}
    .footer{margin:2rem 0;color:var(--muted);font-size:.85rem;text-align:center}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="brand">Flexcoin — $FLEX</div>
    <div class="spacer"></div>

    <a id="btn-x" class="btn chip" href="#" target="_blank" rel="noopener">X</a>
    <a id="btn-tg" class="btn chip" href="#" target="_blank" rel="noopener">Telegram</a>
    <a id="btn-pcs" class="btn" href="javascript:void(0)">Buy on PancakeSwap</a>

    <div class="lang">
      <button id="lang-en">EN</button>
      <button id="lang-ko">KR</button>
    </div>
  </div>

  <div class="wrap">
    <!-- Hero -->
    <section class="card hero">
      <img id="hero-main" src="./public/hero/main.jpg" alt="hero">
    </section>
    <section class="hero-rot">
      <img src="./public/hero/1.jpg" alt="">
      <img src="./public/hero/2.jpg" alt="">
      <img src="./public/hero/3.jpg" alt="">
      <img src="./public/hero/4.jpg" alt="">
      <img src="./public/hero/5.jpg" alt="">
      <img src="./public/hero/6.jpg" alt="">
      <img src="./public/hero/7.jpg" alt="">
      <img src="./public/hero/8.jpg" alt="">
    </section>

    <!-- NFT Preview -->
    <section class="card mt">
      <div class="section-title" id="t-nft-title">NFT Preview</div>
      <div class="grid4" id="nft-grid">
        <img src="./public/nft-preview/1.jpg" alt="">
        <img src="./public/nft-preview/2.jpg" alt="">
        <img src="./public/nft-preview/3.jpg" alt="">
        <img src="./public/nft-preview/4.jpg" alt="">
        <img src="./public/nft-preview/5.jpg" alt="">
        <img src="./public/nft-preview/6.jpg" alt="">
        <img src="./public/nft-preview/7.jpg" alt="">
        <img src="./public/nft-preview/8.jpg" alt="">
      </div>
      <div class="muted" id="nft-note">Upload 1..8.jpg (1600×900) to /public/nft-preview/</div>
    </section>

    <!-- Tokenomics -->
    <section class="card mt">
      <div class="section-title" id="section_tokenomics">Tokenomics</div>
      <div class="row">
        <canvas id="donut" width="300" height="300"></canvas>
        <div>
          <ul class="legend" id="legend"></ul>
          <div class="muted" id="caps"></div>
          <button id="btn-pinksale" class="btn mt">Pinksale (coming soon)</button>
        </div>
      </div>
    </section>

    <!-- Presale countdown -->
    <section class="card mt">
      <div class="section-title">Presale Countdown</div>
      <div class="count" id="countdown">—</div>
      <div class="muted" id="countdown-range">—</div>
    </section>

    <!-- Whitepaper -->
    <section class="card mt">
      <div class="section-title">Whitepaper</div>
      <div class="downloads">
        <a class="link" href="./whitepaper/whitepaper-en.pdf" download>EN</a>
        <a class="link" href="./whitepaper/whitepaper-ko.pdf" download>KO</a>
        <a class="link" href="./whitepaper/whitepaper-ja.pdf" download>JA</a>
        <a class="link" href="./whitepaper/whitepaper-zh.pdf" download>ZH</a>
        <a class="link" href="./whitepaper/whitepaper-es.pdf" download>ES</a>
        <a class="link" href="./whitepaper/whitepaper-de.pdf" download>DE</a>
        <a class="link" href="./whitepaper/whitepaper-pt.pdf" download>PT</a>
        <a class="link" href="./whitepaper/whitepaper-it.pdf" download>IT</a>
      </div>
      <div class="muted">※ 다운로드가 막히면 새 탭에서 열림 → “다른 이름으로 저장”.</div>
    </section>

    <!-- Addresses -->
    <section class="card mt addr">
      <div class="section-title">Addresses</div>
      <table id="addr-table"></table>
    </section>

    <div class="footer">Flexcoin V5.9 • runtime JSON • static GitHub Pages</div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox"><img alt=""></div>

  <script>
    /* ===== Helpers ===== */
    const $ = (q, r=document)=>r.querySelector(q);
    const $$ = (q, r=document)=>[...r.querySelectorAll(q)];
    const fetchJSON = async (p) => (await fetch(p,{cache:'no-cache'})).json();

    /* ===== Lang (runtime i18n) ===== */
    const i18nEls = {
      nftTitle: $('#t-nft-title'),
      nftNote:  $('#nft-note'),
      tokenomicsTitle: $('#section_tokenomics'),
    };
    async function applyLang(lang){
      try{
        const m = await fetchJSON(`./public/i18n/${lang}.json`);
        i18nEls.nftTitle.textContent = m["t-nft-title"] ?? "NFT Preview";
        i18nEls.nftNote.textContent  = m["nft.note"] ?? i18nEls.nftNote.textContent;
        $('#section_tokenomics').textContent = m["section_tokenomics"] ?? "Tokenomics";
      }catch(e){ console.warn('i18n load fail', e) }
      localStorage.setItem('lang', lang);
      $('#lang-en').classList.toggle('active', lang==='en');
      $('#lang-ko').classList.toggle('active', lang==='ko');
    }
    $('#lang-en').onclick = ()=>applyLang('en');
    $('#lang-ko').onclick = ()=>applyLang('ko');
    applyLang(localStorage.getItem('lang')||'en');

    /* ===== Hero rotator ===== */
    $$('.hero-rot img').forEach(img=>{
      img.addEventListener('click', ()=> $('#hero-main').src = img.src);
    });

    /* ===== Lightbox ===== */
    const lb = $('#lightbox'); const lbImg = $('#lightbox img');
    function bindLightbox(containerSel){
      $$(containerSel+' img').forEach(el=>{
        el.addEventListener('click', ()=>{ lbImg.src = el.src; lb.style.display='grid'; })
      });
    }
    bindLightbox('.grid4');            // NFT
    bindLightbox('.hero-rot');         // Hero thumbs
    lb.addEventListener('click', ()=>{ lb.style.display='none'; lbImg.src=''; });

    /* ===== Links & Addresses (runtime JSON) ===== */
    async function wireRuntime(){
      try{
        const links = await fetchJSON('./public/config/links.json');
        const pcs = $('#btn-pcs'), tg = $('#btn-tg'), x = $('#btn-x'), ps = $('#btn-pinksale');

        const setBtn = (btn, url, labelWhenMissing)=>{
          if(url && /^https?:\/\//.test(url)){ btn.href=url; btn.target='_blank'; btn.rel='noopener'; btn.disabled=false; }
          else { btn.removeAttribute('href'); btn.disabled=true; if(labelWhenMissing) btn.textContent=labelWhenMissing; }
        };
        setBtn(x,  links.x_url);
        setBtn(tg, links.tg_url);
        setBtn(pcs, links.pancakeswap_url, 'Buy on PancakeSwap (soon)');
        setBtn(ps, links.pinksale_url, 'Pinksale (coming soon)');

        const addr = await fetchJSON('./public/config/addresses.json');
        const rows = [
          ['Token', addr.token],
          ['Team/Lock', addr.team_lock],
          ['Marketing', addr.marketing],
          ['Presale', addr.presale],
          ['Burn', addr.burn],
          ['User', addr.user]
        ];
        const tbl = $('#addr-table'); tbl.innerHTML = rows.map(([k,v])=>`<tr><td>${k}</td><td>${v||'—'}</td></tr>`).join('');
      }catch(e){ console.warn('links/addresses load fail', e) }
    }
    wireRuntime();

    /* ===== Tokenomics donut ===== */
    function drawDonut(ctx, parts, colors){
      const sum = parts.reduce((a,b)=>a+b,0) || 1;
      let a0 = -Math.PI/2;
      parts.forEach((v,i)=>{
        const a1 = a0 + 2*Math.PI*(v/sum);
        ctx.beginPath(); ctx.moveTo(150,150);
        ctx.arc(150,150,140,a0,a1); ctx.closePath();
        ctx.fillStyle = colors[i]; ctx.fill();
        a0 = a1;
      });
      ctx.globalCompositeOperation='destination-out';
      ctx.beginPath(); ctx.arc(150,150,80,0,2*Math.PI); ctx.fill();
      ctx.globalCompositeOperation='source-over';
    }
    async function renderTokenomics(){
      const def = { lp:54, presale:20, team:15, marketing:10, burn:1, softcap:'—', hardcap:'—' };
      let conf = def;
      try{
        const j = await fetchJSON('./public/config/allocations.json');
        conf = { ...def, ...j };
      }catch(_){}
      const nums = [conf.lp, conf.presale, conf.team, conf.marketing, conf.burn].map(x=>Number(x)||0);
      const ctx = $('#donut').getContext('2d');
      drawDonut(ctx, nums, ['#ffd85a','#ff944d','#53d878','#4da1ff','#ff6b6b']);
      const labels = ['LP','Presale','Team','Marketing','Burn'];
      $('#legend').innerHTML = labels.map((n,i)=>`
        <li><span class="dot" style="background:${['#ffd85a','#ff944d','#53d878','#4da1ff','#ff6b6b'][i]}"></span>
          ${n}: <b>${nums[i]}%</b></li>`).join('');
      $('#caps').innerHTML = `Softcap: <b>${conf.softcap}</b> / Hardcap: <b>${conf.hardcap}</b>`;
    }
    renderTokenomics();

    /* ===== Presale countdown ===== */
    function fmt(n){ return String(n).padStart(2,'0'); }
    let timer;
    async function startCountdown(){
      try{
        const p = await fetchJSON('./public/config/presale.json');
        const start = new Date(p.start_iso);
        const end   = new Date(p.end_iso);
        $('#countdown-range').textContent = `${start.toLocaleString()} → ${end.toLocaleString()}`;
        clearInterval(timer);
        timer = setInterval(()=>{
          const now = new Date();
          let t = (now < start) ? (start-now) : (end-now);
          if(t <= 0){ $('#countdown').textContent = '—'; clearInterval(timer); return; }
          const d = Math.floor(t/86400000); t%=86400000;
          const h = Math.floor(t/3600000);  t%=3600000;
          const m = Math.floor(t/60000);    t%=60000;
          const s = Math.floor(t/1000);
          $('#countdown').textContent = `${d}d ${fmt(h)}:${fmt(m)}:${fmt(s)}`;
        }, 1000);
      }catch(e){ $('#countdown').textContent='—'; }
    }
    startCountdown();
  </script>
</body>
</html>
